<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8"/>
    <title>Pagination</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">






    <script>

             function cancelLike(post_id) {

            $.ajax({
                type: "POST",
                url: "/api/cancellike",
                data: {
                    click_give : post_id
                },
                success: function (response) {
                    window.location.reload()

                }
            });

        }


                     function clickLike(post_id) {

            $.ajax({
                type: "POST",
                url: "/api/clicklike",
                data: {
                    click_give : post_id
                },
                success: function (response) {
                    window.location.reload()
                }
            });

        }
    </script>
</head>
<body>

<!--        all_posts=all_posts,-->
<!--        total_count=total_count,-->
<!--        postsLimit=postsLimit,-->
<!--        nowPage_receive=nowPage_receive,-->
<!--        block_start=block_start,-->
<!--        block_last=block_last,-->
<!--        last_page=last_page-->


<!-- Í∏Ä ÎùÑÏö∏ Îïå ÏÇ¨Ïö©ÏûêÍ∞Ä Ïñ¥Îñ§Í∏ÄÏóê Ïñ¥Îñ§Í∏ÄÏùÑ Ï¢ãÏïÑÏöî
ÎàåÎ†ÄÎäîÏßÄ ÌôïÏù∏ ÌõÑ ÍΩâÏ∞¨ ÌïòÌä∏ ÌëúÏãú
AÏÇ¨Ïö©ÏûêÏùò 5Î≤àÍ∏ÄÏóê LikesÍ∞Ä 1Ïù∏ÏßÄ Î≠òÎ°ú ÌôïÏù∏ ?

Likes DB ( Ïñ¥Îñ§ ÏÇ¨Ïö©ÏûêÍ∞Ä Ïñ¥Îñ§ Ìè¨Ïä§Ìä∏Ïóê ÎùºÏù¥ÌÅ¨Î•º ÎàåÎ†ÄÎäîÏßÄ ÌôïÏù∏ )
ÏïÑÎûòÏôÄ Í∞ôÏù¥ ? (Ï¢ãÏïÑÏöîÎ•º ÎπºÎ©¥ ÏïÑÎûò Îç∞ Ìè¨Ïä§Ìä∏ ÏïÑÏù¥Îîî ÏÇ≠Ï†ú Ï¢ãÏïÑÏöî)
post_idÎ•º Î∞∞Ïó¥Î°ú Îã§Î£®Í∏∞
id          post_id
A              1, 3
B              3


Post DB ( Í≤åÏãúÍ∏ÄÏùò LikesÍ∞Ä Î™áÏù∏ÏßÄÎßå ÌôïÏù∏ )
post_id      Likes
1               1
2               0
3               2





-->
{% if (total_count | string) | length != 0 %}
<table>
    <thead>
    <tr>
        <td>Î≤àÌò∏</td>
        <td>Ï†úÎ™©</td>
        <td>Ïù¥Î¶Ñ</td>
        <td>likes</td>
    </tr>
    </thead>
    <tbody>
    <!-- Î∞òÎ≥µÎêòÎäî Íµ¨Í∞Ñ -->
    {% for post in all_posts %}
    <tr>
        <!-- Í≤åÏãúÎ¨º ÏàúÏÑúÎåÄÎ°ú Î≤àÌò∏ Î∂ÄÏó¨ÌïòÍ∏∞ -->
        <!-- ÏïÑÎûò Î£®ÌîÑ Ïù∏Îç±Ïä§ ÏóÜÏï†Í≥† Ìï¥Îãπ Í≤åÏãúÍ∏Ä dbÏùò Ìè¨Ïä§Ìä∏Î≤àÌò∏ Î∂àÎü¨Ïò§Í∏∞ -->
<!--        <td>{{loop.index + (nowPage_receive - 1) * postsLimit}}</td>-->
        <td>{{post.post_num}}</td>
        <td><a href="">{{post.crudtitle}}</a></td>
<!--        <td>{{post.name}}</td>-->
<!--        <td>{{post.view}}</td>-->

        {% set index = loop.index + (nowPage_receive - 1) * postsLimit %}

        {% if (likes_array | string) | length != 0 %}

        {% for like in likes_array %}
        {% if like == index %}
        <td>
            <button class="like" onclick="cancelLike('{{ post.post_num }}')">‚ù§Ô∏è</button>
        </td>
        {% endif %}
        {% endfor %}


        {% for like in likes_array %}

        {% if like == post.post_num %}
            {% break %}
        {% endif %}

        {% if ((like != post.post_num) and ( like == 0)): %}
        <td>
            <button class="like" onclick="clickLike('{{ post.post_num }}')">Ô∏èü§ç</button>
        </td>
        {% break %}
        {% endif %}
        {% endfor %}





        {% endif %}
    </tr>
    {% endfor %}
    <!-- Î∞òÎ≥µÎêòÎäî Íµ¨Í∞Ñ ÎÅù -->
    </tbody>
    </table>


<nav aria-label="...">
    <ul class="pagination">

{% if block_start - 1 > 0 %}
    <li class="page-item">
      <a class="page-link" href="{{url_for('pagination', nowPage_give=block_start - 1)}}">Previous</a>
    </li>
        {% else %}
    <li class="page-item disabled">
      <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
    </li>
{% endif %}

        {% for i in range(block_start, block_last + 1) %}
                <!-- Îç∞Ïù¥ÌÑ∞Í∞Ä Ï°¥Ïû¨ÌïòÏßÄ ÏïäÎäî ÌéòÏù¥ÏßÄÎäî ÌôîÎ©¥Ïóê ÎÇòÌÉÄÎÇ¥ÏßÄ ÏïäÍ∏∞ ÏúÑÌïú Ï°∞Í±¥Î¨∏ -->
        {% if i > last_page %}

        {% else %}
            {% if i == nowPage_receive %}
        <li class="page-item active" aria-current="page">
            <a class="page-link" href="#">{{ i }}</a>
        </li>
            {% else %}
                <li class="page-item"><a class="page-link" href="{{url_for('pagination', nowPage_give=i)}}">{{ i }}</a></li>
            {% endif %}
        {% endif %}
{% endfor %}

{% if block_last < last_page %}
    <li class="page-item">
      <a class="page-link" href="{{url_for('pagination', nowPage_give=block_last + 1)}}">Next</a>
    </li>
        {% else %}
    <li class="page-item disabled">
      <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Next</a>
    </li>
{% endif %}

  </ul>
</nav>

{% endif %}



</body>
</html>





