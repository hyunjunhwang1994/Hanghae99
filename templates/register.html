<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

    <script type="text/javascript" src="<%=ctxPath %>/script/RSA/rsa.js">
    </script>
    <script type="text/javascript" src="<%=ctxPath %>/script/RSA/jsbn.js">
    </script>
    <script type="text/javascript" src="<%=ctxPath %>/script/RSA/prng4.js">
    </script>
    <script type="text/javascript" src="<%=ctxPath %>/script/RSA/rng.js">
    </script>

<style>
    .signUpBox {
        width: 95%;
        max-width: 500px;
        margin: 20px auto 0 auto;
        padding: 20px;
        box-shadow: 0 0 3px 0 gray;

    }


</style>

<script>

    function signUp() {
        let id = document.getElementById('inputID').value
        let pw = document.getElementById('inputPW1').value
        let nick = document.getElementById('inputNick').value
        let email = document.getElementById('inputEmail').value
        $.ajax({
                type: "POST",
                url: "/api/join",
                data: {
                    id_give: id,
                    pw_give: pw,
                    nick_give: nick,
                    email_give: email,
                },
                success: function (response) {
                    alert(response)
                    window.location.href='/'
                }
            });
    }
    function checkID() {
            let id = document.getElementById('inputID').value

            $.ajax({
                type: "POST",
                url: "/checkID",
                data: {id_give: id},
                success: function (response) {

                    //    response의 값이 '0' 일시 중복 없음 '1'일시 중복.  0과 1은 문자열. app.py에서 숫자값 반환 불가.
                    if (response === '1') {
                        bool_ID = true

                        document.getElementById('chkID_text').innerText = '사용 가능한 아이디 입니다.'
                        document.getElementById('chkID_text').style.color = 'blue'
                    } else {
                        bool_ID = false

                        document.getElementById('chkID_text').innerText = '이미 사용중인 아이디 입니다.'
                        document.getElementById('chkID_text').style.color = 'red'
                    }
                }
            })
        }

    $(function () {
        $('#inputPW1').keyup(function () {
            document.getElementById('chkPW_text').innerHTML = ''
        });

        $('#inputPW2').keyup(function () {
            document.getElementById('chkPW_text').innerHTML = ''

            if ($('#inputPW1').val() == $('#inputPW2').val()) {
                document.getElementById('chkPW_text').innerText = '비밀번호 일치함'
                document.getElementById('chkPW_text').style.color = 'blue'
            } else {
                document.getElementById('chkPW_text').innerText = '비밀번호 일치하지 않음'
                document.getElementById('chkPW_text').style.color = 'red'
            }

        });
    });



</script>

<body>
<div class="signUpBox">
    <h1>회원등록</h1>

    <p> ID <input type="text" class="form-control" id="inputID" placeholder="ID"/>
    <button onclick="checkID()" type="button" class="btn btn-outline-primary">중복 확인</button>
    <b id="chkID_text"></b>
    </p>
<!--    <button onclick="dupCheck()">중복확인</button> -->
    <p> PW <input type="password" class="form-control" id="inputPW1" placeholder="비밀번호"/>
    </p>
    <p> PW확인 <input type="password" class="form-control" id="inputPW2" placeholder="비밀번호 확인"/>
    <h6 id="chkPW_text"></h6>
    </p>
    <p> 닉네임 <input type="text" class="form-control" id="inputNick" placeholder="닉네임"/>
    </p>
    <p> 이메일 <input type="email" class="form-control" id="inputEmail" placeholder="example@email.com"/>
    </p>

<!--        <button onclick="doubleCheck()">중복확인</button> -->
    <p> <button  onclick="signUp()">등록하기</button>
        <button onclick="location.href = '/'">취소</button>
    </p>
</div>
</body>
</html>